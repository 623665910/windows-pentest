# windows-pentest
Windows Pentest Scripts


### wmic-info - Retrieve system info.
Uses WMIC to gather various important informatoon about a windows host and dump it to HTML.

### icacls.bat - Weak permissions on Services.
* Script that queries all services. 
* Removes default tasks and ny Microsot related. 
* Then checks the  BINARY_PATHS for any exeuctables that have the Everyone or Usergroup set with RW access.

### schcheck.bat - Weak permissions on scheduled task executables.
* Lists all schededuled tasks. 
* Runs list of executables against icacls and checks if any allow Everyone RW permissions.

### adduser.c - Creates user and adds to administrator group.
* Creates a user called sharepoint with password sharepoint. Add's user to local administrators group. 
* To cross compile on kali - i686-w64-mingw32-gcc -o useradd.exe useradd.c 


### Powershell/powershell_download_file.txt - Create wget powershell script to download external files.

* Copy gile contents to clipboard using > `cat powershell_download_file.txt | xclip -selection clipboard`
* Paste into Windows command prompt which create wget.ps1
* `powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1`
