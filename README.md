# windows-pentest
Windows Pentest Scripts


#### wmic-info - Retrieve system info.
Uses WMIC to gather various important informatoon about a windows host and dump it to HTML.

#### icacls.bat - Weak permissions on Services.
* Script that queries all services. 
* Removes default tasks and ny Microsot related. 
* Then checks the  BINARY_PATHS for any exeuctables that have the Everyone or Usergroup set with RW access.

#### schcheck.bat - Weak permissions on scheduled task executables.
* Lists all schededuled tasks. 
* Runs list of executables against icacls and checks if any allow Everyone RW permissions.

#### adduser.c - Creates user and adds to administrator group.
* Creates a user called sharepoint with password sharepoint. Add's user to local administrators group. 
* To cross compile on kali - i686-w64-mingw32-gcc -o useradd.exe useradd.c 


#### Powershell/powershell_download_file.txt - Create wget powershell script to download external files.

* Copy gile contents to clipboard using > `cat powershell_download_file.txt | xclip -selection clipboard`
* Paste into Windows command prompt which create wget.ps1
* `powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1`

#### Privelege/Accesschk-2003-xp.exe & accesschk-2008-vista.exe
##### Identify the level of access a particular user or groups have to files, directories, Registry keys.

The following command reports the accesses that the Power Users account has to files and directories in \Windows\System32:

     accesschk "power users" c:\windows\system32

This command shows which Windows services members of the Users group have write access to:

     accesschk users -cw *

Check what access authenticated users have to services.

     accesschk.exe -uwcqv "Authenticated Users" *

Check which Windows services a user called adam.dale has write access to:

      accesschk.exe -uwcqv adam.dale *

Check to see what access permissions are set on the serice called NetLogon

     accesschk.exe -ucqv NetLogon

To see what Registry keys under HKLM\CurrentUser a specific account has no access to:

     accesschk -kns austin\mruss hklm\software

To see the security on the HKLM\Software key:

     accesschk -k hklm\software

To see all files under \Users\Mark on Vista that have an explicit integrity level:

     accesschk -e -s c:\users\mark

To see all global objects that Everyone can modify:

     accesschk -wuo everyone \basednamedobjects
